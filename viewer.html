<!DOCTYPE html>
<html>
<head>
    <title>OpenSeadragon DZI Viewer</title>
    <script src="https://cdn.jsdelivr.net/npm/openseadragon@4.0.0/build/openseadragon/openseadragon.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        #viewer {
            width: 100%;
            height: 90vh;
        }
        .controls {
            padding: 10px;
            background: #f0f0f0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="controls">
        <h2>OpenSeadragon DZI Viewer</h2>
        <p>Drag to pan, mouse wheel to zoom. Right-click for more options.</p>
    </div>
    <div id="viewer"></div>

    <script>
        // Get the DZI path from URL parameters or use default
        const urlParams = new URLSearchParams(window.location.search);
        const dziPath = urlParams.get('dzi') || 'output.dzi';

        // Initialize OpenSeadragon
        const viewer = OpenSeadragon({
            id: "viewer",
            prefixUrl: "https://cdn.jsdelivr.net/npm/openseadragon@4.0.0/build/openseadragon/images/",
            tileSources: {
                Image: {
                    xmlns: "http://schemas.microsoft.com/deepzoom/2008",
                    Url: dziPath.replace('.dzi', '_files/'),
                    Format: 'jpg',
                    Overlap: 1,
                    TileSize: 254,
                    Size: {
                        Width: 0,  // Will be set by OpenSeadragon
                        Height: 0  // Will be set by OpenSeadragon
                    }
                }
            },
            showNavigationControl: true,
            showNavigator: true,
            navigatorPosition: 'BOTTOM_RIGHT',
            showRotationControl: true,
            showHomeControl: true,
            showFullPageControl: true
        });

        // Handle any errors
        viewer.addHandler('open-failed', function(event) {
            console.error('Failed to open DZI:', event);
            alert('Failed to load the DZI file. Please check the console for details.');
        });
    </script>
</body>
</html>
